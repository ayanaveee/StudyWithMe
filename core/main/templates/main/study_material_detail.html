{% extends 'base.html' %}
{% load static %}

{% block content %}
<style>
    .lesson-container {
        max-width: 700px;
        margin: 50px auto;
        background-color: #f9f9f9;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        text-align: center;
        animation: fadeIn 1s ease-in-out;
    }

    .lesson-title {
        font-size: 36px;
        margin-bottom: 25px;
        color: #333;
        font-weight: 700;
    }

    .lesson-description {
        font-size: 18px;
        color: #555;
        line-height: 1.6;
        margin-bottom: 30px;
    }

    .icon-book {
        font-size: 48px;
        color: #6c63ff;
        margin-bottom: 20px;
    }

    .timer {
        font-size: 28px;
        margin-bottom: 20px;
        color: #222;
    }

    .timer-buttons button {
        margin: 0 10px;
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .start-btn {
        background-color: #6c63ff;
        color: white;
    }

    .pause-btn {
        background-color: #ffb347;
        color: white;
    }

    .reset-btn {
        background-color: #ff6f61;
        color: white;
    }

    .timer-buttons button:hover {
        opacity: 0.9;
    }

    .favorite-btn {
        background-color: #eee;
        color: #444;
        border: none;
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.3s, color 0.3s;
    }

    .favorite-btn.active {
        background-color: #ff6b81;
        color: white;
    }

    @keyframes fadeIn {
        0% {
            opacity: 0;
            transform: translateY(20px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>

<div class="lesson-container">
    <div class="icon-book">üìò</div>
    <h1 class="lesson-title">{{ material.title }}</h1>
    <p class="lesson-description">
        <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> {{ material.description }}
    </p>
    <p> {{ material.video | safe }}</p>

    <form method="post" action="{% url 'add_to_favorites' material.id %}" id="favoriteForm">
        {% csrf_token %}
        <button type="submit" id="favoriteBtn" class="favorite-btn">üíñ –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
    </form>

    <div class="timer" id="timer">00:00:00</div>
    <div class="timer-buttons">
        <button class="start-btn" onclick="startTimer()">–°—Ç–∞—Ä—Ç</button>
        <button class="pause-btn" onclick="pauseTimer()">–ü–∞—É–∑–∞</button>
        <button class="reset-btn" onclick="resetTimer()">–°–±—Ä–æ—Å</button>
    </div>
</div>

<script>
    let timer;
    let seconds = 0;
    let running = false;

    function updateTimerDisplay() {
        let hrs = String(Math.floor(seconds / 3600)).padStart(2, '0');
        let mins = String(Math.floor((seconds % 3600) / 60)).padStart(2, '0');
        let secs = String(seconds % 60).padStart(2, '0');
        document.getElementById('timer').innerText = `${hrs}:${mins}:${secs}`;
    }

    function startTimer() {
        if (!running) {
            running = true;
            timer = setInterval(() => {
                seconds++;
                updateTimerDisplay();
            }, 1000);
        }
    }

    function pauseTimer() {
        running = false;
        clearInterval(timer);
    }

    function resetTimer() {
        running = false;
        clearInterval(timer);
        seconds = 0;
        updateTimerDisplay();
    }

    updateTimerDisplay();

    // –ü–ª–∞–≤–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ "–≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"
    document.getElementById('favoriteForm').addEventListener('submit', function(event) {
        const btn = document.getElementById('favoriteBtn');
        btn.classList.add('active');
    });
</script>
{% endblock %}