{% extends 'base.html' %}
{% load static %}
{% block content %}
<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,700&display=swap" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

<section id="about" class="position-relative text-light" style="
    font-family: 'Poppins', sans-serif;
    min-height: 100vh;
    padding: 80px 20px;
    background: url('/static/assets/img/bg-callout.jpg') center center / cover no-repeat fixed;
    overflow: hidden;
">
  <div class="container position-relative" style="max-width:720px; z-index: 10;">
    <h2 class="mb-5 display-4 fw-bold text-gradient" style="background: linear-gradient(90deg, #fff176, #fbc02d); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
      –û –Ω–∞—Å
    </h2>


    <div id="story-container" class="d-flex flex-column gap-4">

      <div class="story-item p-4 rounded-4 shadow-lg bg-dark bg-opacity-75 cursor-pointer" data-index="1" role="button" tabindex="0" aria-expanded="false">
        <div class="d-flex align-items-center justify-content-between">
          <h3 class="mb-0 fw-semibold fs-4 d-flex align-items-center gap-2">
            üöÄ –ù–∞—à —Å—Ç–∞—Ä—Ç
            <svg class="icon-arrow" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transition: transform 0.3s ease;" viewBox="0 0 24 24">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </h3>
        </div>
        <p class="story-text mt-3 text-light collapse" style="font-weight: 300; line-height: 1.5;">
          –ú—ã –Ω–∞—á–∞–ª–∏ —Å –ø—Ä–æ—Å—Ç–æ–π –∏–¥–µ–∏ ‚Äî —Å–¥–µ–ª–∞—Ç—å –∂–∏–∑–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ª–µ–≥—á–µ –∏ —è—Ä—á–µ —Å –ø–æ–º–æ—â—å—é —É–¥–æ–±–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.
        </p>
      </div>

      <div class="story-item p-4 rounded-4 shadow-lg bg-dark bg-opacity-75 cursor-pointer" data-index="2" role="button" tabindex="0" aria-expanded="false">
        <div class="d-flex align-items-center justify-content-between">
          <h3 class="mb-0 fw-semibold fs-4 d-flex align-items-center gap-2">
            üå± –†–æ—Å—Ç –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ
            <svg class="icon-arrow" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transition: transform 0.3s ease;" viewBox="0 0 24 24">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </h3>
        </div>
        <p class="story-text mt-3 text-light collapse" style="font-weight: 300; line-height: 1.5;">
          –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º—ã —Ä–∞—Å—à–∏—Ä—è–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π –º–æ–≥ –Ω–∞–π—Ç–∏ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –∏–º–µ–Ω–Ω–æ –µ–º—É.
        </p>
      </div>

      <div class="story-item p-4 rounded-4 shadow-lg bg-dark bg-opacity-75 cursor-pointer" data-index="3" role="button" tabindex="0" aria-expanded="false">
        <div class="d-flex align-items-center justify-content-between">
          <h3 class="mb-0 fw-semibold fs-4 d-flex align-items-center gap-2">
            üí° –ù–∞—à–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏
            <svg class="icon-arrow" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transition: transform 0.3s ease;" viewBox="0 0 24 24">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </h3>
        </div>
        <p class="story-text mt-3 text-light collapse" style="font-weight: 300; line-height: 1.5;">
          –ú—ã –≤–µ—Ä–∏–º –≤ –ø—Ä–æ—Å—Ç–æ—Ç—É, —á–µ—Å—Ç–Ω–æ—Å—Ç—å –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ ‚Äî –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –ª–µ–∂–∞—Ç –≤ –æ—Å–Ω–æ–≤–µ –Ω–∞—à–µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.
        </p>
      </div>

      <div class="story-item p-4 rounded-4 shadow-lg bg-dark bg-opacity-75 cursor-pointer" data-index="4" role="button" tabindex="0" aria-expanded="false">
        <div class="d-flex align-items-center justify-content-between">
          <h3 class="mb-0 fw-semibold fs-4 d-flex align-items-center gap-2">
            üåà –ë—É–¥—É—â–µ–µ
            <svg class="icon-arrow" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transition: transform 0.3s ease;" viewBox="0 0 24 24">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </h3>
        </div>
        <p class="story-text mt-3 text-light collapse" style="font-weight: 300; line-height: 1.5;">
          –ú—ã –ø–ª–∞–Ω–∏—Ä—É–µ–º —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è –≤–º–µ—Å—Ç–µ —Å –≤–∞–º–∏, –¥–µ–ª–∞—è —Å–µ—Ä–≤–∏—Å –≤—Å—ë —É–¥–æ–±–Ω–µ–µ –∏ –ø—Ä–∏—è—Ç–Ω–µ–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.
        </p>
      </div>
    </div>

    <div class="d-flex justify-content-center gap-3 mt-4">
      <button id="open-all" class="btn btn-outline-light px-4 fw-semibold" aria-label="–û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ –ø—É–Ω–∫—Ç—ã">–û—Ç–∫—Ä—ã—Ç—å –≤—Å—ë</button>
      <button id="close-all" class="btn btn-outline-light px-4 fw-semibold" aria-label="–ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –ø—É–Ω–∫—Ç—ã">–ó–∞–∫—Ä—ã—Ç—å –≤—Å—ë</button>
    </div>

    <div class="progress mt-4 rounded-pill" style="height:12px; background: rgba(255 255 255 / 0.2);">
      <div id="progress-bar" class="progress-bar bg-gradient" role="progressbar" style="width: 0%;" aria-valuemin="0" aria-valuemax="100"></div>
    </div>

    <div class="d-flex justify-content-center gap-4 mt-5">
      <a href="#" class="social-link" aria-label="Facebook" target="_blank" rel="noopener noreferrer">
        <svg width="28" height="28" fill="currentColor" viewBox="0 0 24 24"><path d="M22 12.07c0-5.51-4.49-10-10-10S2 6.56 2 12.07c0 4.99 3.66 9.12 8.44 9.88v-6.99h-2.54v-2.89h2.54V9.42c0-2.5 1.49-3.89 3.77-3.89 1.09 0 2.23.2 2.23.2v2.47h-1.25c-1.23 0-1.61.77-1.61 1.56v1.87h2.74l-.44 2.89h-2.3v6.99C18.34 21.19 22 17.06 22 12.07z"/></svg>
      </a>
      <a href="#" class="social-link" aria-label="Twitter" target="_blank" rel="noopener noreferrer">
        <svg width="28" height="28" fill="currentColor" viewBox="0 0 24 24"><path d="M23 3a10.9 10.9 0 01-3.14.86 5.5 5.5 0 002.4-3.03 10.87 10.87 0 01-3.47 1.32 5.48 5.48 0 00-9.32 5 15.54 15.54 0 01-11.3-5.7 5.46 5.46 0 001.7 7.31 5.4 5.4 0 01-2.48-.68v.07a5.48 5.48 0 004.4 5.38 5.52 5.52 0 01-2.47.1 5.48 5.48 0 005.11 3.82 11 11 0 01-7.2 2.48c-.47 0-.93-.03-1.38-.08A15.54 15.54 0 008.29 21c10.01 0 15.5-8.3 15.5-15.5 0-.24 0-.48-.02-.72A11.11 11.11 0 0023 3z"/></svg>
      </a>
      <a href="#" class="social-link" aria-label="Instagram" target="_blank" rel="noopener noreferrer">
        <svg width="28" height="28" fill="currentColor" viewBox="0 0 24 24"><path d="M7.75 2h8.5C19.55 2 22 4.45 22 7.75v8.5C22 19.55 19.55 22 16.25 22h-8.5C4.45 22 2 19.55 2 16.25v-8.5C2 4.45 4.45 2 7.75 2zm0 2C5.73 4 4 5.73 4 7.75v8.5c0 2.02 1.73 3.75 3.75 3.75h8.5c2.02 0 3.75-1.73 3.75-3.75v-8.5C20 5.73 18.27 4 16.25 4h-8.5zM12 7a5 5 0 110 10 5 5 0 010-10zm0 2.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5zm4.75-3.25a1.25 1.25 0 11-2.5 0 1.25 1.25 0 012.5 0z"/></svg>
      </a>
    </div>
  </div>
</section>

<style>

  .cursor-pointer {
    cursor: pointer;
    user-select: none;
  }

  .collapse {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.5s ease, opacity 0.4s ease;
    opacity: 0;
  }
  .collapse.show {
    opacity: 1;
  }

  .story-item[aria-expanded="true"] .icon-arrow {
    transform: rotate(180deg);
  }

  .story-item:hover {
    transform: scale(1.03);
    box-shadow: 0 12px 25px rgba(106, 58, 255, 0.4);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .story-item:active {
    transform: scale(0.98);
  }

  .progress-bar.bg-gradient {
    background: linear-gradient(90deg, #8e2de2, #4a00e0);
    transition: width 0.4s ease;
  }

  .social-link {
    color: #d1c4e9;
    transition: color 0.3s ease, transform 0.3s ease;
  }
  .social-link:hover,
  .social-link:focus {
    color: #8e2de2;
    transform: scale(1.2);
  }
</style>

<script>
  const storyItems = document.querySelectorAll('.story-item');
  const progressBar = document.getElementById('progress-bar');
  const openAllBtn = document.getElementById('open-all');
  const closeAllBtn = document.getElementById('close-all');

  function updateProgress() {
    let opened = 0;
    storyItems.forEach(item => {
      if (item.getAttribute('aria-expanded') === 'true') opened++;
    });
    let percent = (opened / storyItems.length) * 100;
    progressBar.style.width = percent + '%';
  }

  function toggleItem(item) {
    const isOpen = item.getAttribute('aria-expanded') === 'true';
    if (isOpen) {
      item.setAttribute('aria-expanded', 'false');
      item.querySelector('.story-text').classList.remove('show');
      item.querySelector('.story-text').style.maxHeight = null;
    } else {
      item.setAttribute('aria-expanded', 'true');
      const content = item.querySelector('.story-text');
      content.classList.add('show');
      content.style.maxHeight = content.scrollHeight + 'px';
    }
    updateProgress();
  }

  storyItems.forEach(item => {
    item.querySelector('.story-text').style.maxHeight = null;
  });

  storyItems.forEach(item => {
    item.addEventListener('click', () => toggleItem(item));
    item.addEventListener('keydown', e => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        toggleItem(item);
      }
    });
  });

  openAllBtn.addEventListener('click', () => {
    storyItems.forEach(item => {
      item.setAttribute('aria-expanded', 'true');
      const content = item.querySelector('.story-text');
      content.classList.add('show');
      content.style.maxHeight = content.scrollHeight + 'px';
    });
    updateProgress();
  });

  closeAllBtn.addEventListener('click', () => {
    storyItems.forEach(item => {
      item.setAttribute('aria-expanded', 'false');
      const content = item.querySelector('.story-text');
      content.classList.remove('show');
      content.style.maxHeight = null;
    });
    updateProgress();
  });

  updateProgress();

  window.addEventListener('scroll', () => {
    const scrolled = window.pageYOffset;
    const bg = document.querySelector('#about');
    bg.style.backgroundPositionY = -(scrolled * 0.25) + 'px';
  });
</script>
{% endblock %}